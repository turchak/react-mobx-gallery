(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(t,e,n){t.exports=n(37)},34:function(t,e,n){},35:function(t,e,n){},36:function(t,e,n){},37:function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),a=n(8),s=n.n(a),i=n(3),c=n(2),u=n(4),l=n(6),h=n(5),b=n(7),m=n(11),f=n.n(m),d=function(t){function e(){return Object(c.a)(this,e),Object(l.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this.props,e=t.selectedPhotos,n=t.isLoading;return o.createElement(o.Fragment,null,o.createElement(f.a,{size:"l",visible:n,className:"loader"}),o.createElement("ul",null,e.map(function(t){return o.createElement("li",{key:t.id},o.createElement("img",{src:t.thumbnailUrl,alt:t.title}))})))}}]),e}(o.Component),g=Object(i.inject)(function(t){var e=t.rootStore,n=(e.albumsStore,e.routerStore,e.photosStore);return{isLoading:n.isLoading,selectedPhotos:n.selectedPhotos}})(Object(i.observer)(d)),p=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(l.a)(this,Object(h.a)(e).call(this,t))).handleChange=function(t){var e=n.props.getPhotos;window.location.hash="/album/".concat(t.target.value),e(t.target.value)},n.selectRef=new o.createRef,n}return Object(b.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this.props,e=t.fetchAlbums,n=t.fetchPhotos;e(),n()}},{key:"componentDidUpdate",value:function(t){var e=this.props,n=e.albumId,o=e.getPhotos,r=e.photos;if(t.albumId!==n||t.photos.length!==r.length){if(o(n),console.log("TCL: AppContainer -> componentDidUpdate -> albumId",n),!this.props.albumId)return void(this.selectRef.current.value=0);this.selectRef.current.value=n}}},{key:"render",value:function(){var t=this.props,e=t.selectOptions;t.albumId;return o.createElement("div",{className:"container"},o.createElement("select",{className:"select",name:"albums",defaultValue:0,ref:this.selectRef,onChange:this.handleChange},o.createElement("option",{value:"0",disabled:!0},"Choose Album"),e.map(function(t){return o.createElement("option",{key:t.value,value:t.value},t.text)})),o.createElement(g,null))}}]),e}(o.Component),v=Object(i.inject)(function(t){var e=t.rootStore,n=e.albumsStore,o=e.routerStore,r=e.photosStore,a=n.albums.reduce(function(t,e){return t.push({value:e.id,text:e.title}),t},[]),s=function(t,e){if(t.length&&"/"!==e){var n=e.slice(e.lastIndexOf("/")+1,e.length);return Number(n)}return null}(n.albums,o.url);return{url:o.url,fetchPhotos:r.fetchPhotos,fetchAlbums:n.fetchAlbums,changeUrl:o.changeUrl,getPhotos:r.getPhotos,photos:r.photos,selectOptions:a,albumId:s}})(Object(i.observer)(p)),j=n(12),O=n.n(j),w=(n(34),function(t){return r.a.createElement("footer",{className:"footer"})}),E=(n(35),function(t){function e(){return Object(c.a)(this,e),Object(l.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return o.createElement("header",{className:"header"})}}]),e}(o.Component)),L=function(t){function e(){var t,n;Object(c.a)(this,e);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(l.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(a)))).switchRoute=function(t){switch(t){case"/":return o.createElement(v,null);case"/photos":return o.createElement(g,null);default:return o.createElement(v,null)}},n}return Object(b.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this.props.url;return o.createElement(o.Fragment,null,o.createElement(E,null),this.switchRoute(t),o.createElement(w,null),o.createElement(O.a,null))}}]),e}(o.Component),P=Object(i.inject)(function(t){return{url:t.rootStore.routerStore.url,changeUrl:t.rootStore.routerStore.changeUrl}})(Object(i.observer)(L)),S=n(1),I="https://jsonplaceholder.typicode.com",y="".concat(I).concat("/albums"),A="".concat(I).concat("/photos"),C=new function t(){var e=this;Object(c.a)(this,t),this.getAlbums=function(){return e.get(y)},this.getPhotos=function(){return e.get(A)},this.get=function(t){return fetch(t,{method:"get"}).then(function(t,e){return t?t.json():e}).then(function(t){if(t.error){var e=t.message.split("").reduce(function(t,e,n){return 0===n?(t.push(e.toUpperCase()),t):(t.push(e),t)},[]).join("");throw new Error(JSON.stringify({errorCode:t.status,info:t.error,message:e||"Error",status:t.status,timestamp:t.timestamp}))}return t},function(t){throw new Error(JSON.stringify({errorCode:t.status||0,info:t.stack||"Error",message:t.message||"Error",status:t.status||0,timestamp:+new Date}))})}},k=function t(e){var n=this;Object(c.a)(this,t),this.fetchAlbums=function(){n.isLoading=!0,C.getAlbums().then(function(t){return Object(S.runInAction)(function(){n.isLoading=!1,n.albums=t})}).catch(function(t){return Object(S.runInAction)(function(){n.isLoading=!1,n.error=t})})},this.setAlbumId=function(t){n.albumId=t},this.rootStore=e,this.albums=[],this.albumId=null,this.isLoading=!1,this.error=null};Object(S.decorate)(k,{albums:S.observable,albumId:S.observable,isLoading:S.observable,fetchAlbums:S.action});var U=k,N=function t(e){var n=this;Object(c.a)(this,t),this.fetchPhotos=function(){n.isLoading=!0,C.getPhotos().then(function(t){return Object(S.runInAction)(function(){n.isLoading=!1,n.photos=t})}).catch(function(t){return Object(S.runInAction)(function(){n.isLoading=!1,n.error=t})})},this.getPhotos=function(t){if(console.log("TCL: PhotosStore -> id",t),n.selectedPhotos=[],console.log("TCL: PhotosStore -> isLoading",n.isLoading),t&&!n.isLoading){n.isLoading=!0;var e=n.photos.reduce(function(e,n){return n.albumId===Number(t)?(e.push(n),e):e},[]);console.log("TCL: PhotosStore -> sortedPhotos",e),new Promise(function(t,n){var o=0;e.map(function(n){var r=new Image(150,150);return r.src=n.thumbnailUrl,r.onload=function(){o++,e.length===o&&t(e)},n})}).then(function(t){Object(S.runInAction)(function(){console.log("TCL: PhotosStore -> this.isLoading",n.isLoading),n.isLoading?(n.isLoading=!1,n.selectedPhotos=t):n.selectedPhotos=[]})})}},this.rootStore=e,this.photos=[],this.isLoading=!1,this.selectedPhotos=[]};Object(S.decorate)(N,{photos:S.observable,isLoading:S.observable,selectedPhotos:S.observable,fetchAlbums:S.action,getPhotos:S.action});var R=N,T=function t(e){var n=this;Object(c.a)(this,t),this.changeUrl=function(t){n.url="/".concat(t)},this.rootStore=e,this.url=window.location.hash,window.addEventListener("hashchange",function(t){n.changeUrl("".concat(t.target.location.hash))}),this.changeUrl("".concat(window.location.hash))};Object(S.decorate)(T,{url:S.observable,changeUrl:S.action});var x=T,D=function t(){Object(c.a)(this,t),this.albumsStore=new U(this),this.photosStore=new R(this),this.routerStore=new x(this)};n(36),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(i.Provider,{rootStore:new D},r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[13,1,2]]]);
//# sourceMappingURL=main.f8d175cd.chunk.js.map